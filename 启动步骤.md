# 项目启动步骤

## 前置要求
- Node.js 18+
- Docker Desktop（已运行）
- npm 或 yarn

---

## 1. 启动 MySQL 数据库
在终端进入项目目录：

```powershell
cd d:\Code_Repository\studentTalk
```

启动 MySQL 容器：

```powershell
docker-compose up -d mysql
```

查看日志确认就绪（看到 `ready for connections`）：

```powershell
docker logs talk-record-mysql
```

---

## 2. 启动后端服务
打开新终端，进入后端目录：

```powershell
cd d:\Code_Repository\studentTalk\backend
```

安装依赖（若未安装）：

```powershell
npm install
```

生成 Prisma Client：

```powershell
npx prisma generate
```

首次运行推送数据库结构：

```powershell
npx prisma db push
```

启动后端开发服务器：

```powershell
npm run dev
```

后端地址：`http://localhost:3000`

---

## 3. 启动前端服务（H5）
打开新终端，进入前端目录：

```powershell
cd d:\Code_Repository\studentTalk\frontend
```

安装依赖（若未安装）：

```powershell
npm install
```

启动前端 H5：

```powershell
npm run dev:h5
```

前端地址：`http://localhost:5173`

---

## 4. 启动微信小程序开发服务
打开新终端，进入前端目录：

```powershell
cd d:\Code_Repository\studentTalk\frontend
```

安装依赖（若未安装）：

```powershell
npm install
```

启动微信小程序开发服务：

```powershell
npm run dev:mp-weixin
```

编译完成后，会在 `dist/dev/mp-weixin` 目录生成小程序代码。

### 使用微信开发者工具

1. 打开 **微信开发者工具**
2. 选择 **「导入项目」**
3. 目录选择：`d:\Code_Repository\studentTalk\frontend\dist\dev\mp-weixin`
4. 填入您的小程序 AppID（或选择测试号）
5. 点击 **「导入」** 完成

> 💡 提示：修改代码后会自动重新编译，微信开发者工具会自动刷新预览。

### 本地设置（开发阶段）

为了方便本地开发调试：
1. 在微信开发者工具中点击 **「详情」**
2. 切换到 **「本地设置」**
3. 勾选 ✅ **「不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书」**

### 生产构建

如需构建生产版本：

```powershell
npm run build:mp-weixin
```

构建后的代码位于 `dist/build/mp-weixin`，可用于上传发布。

---

## 访问地址
- MySQL：`localhost:3306`
  - 用户：`app`
  - 密码：`app123456`
  - 数据库：`talk_record`
- 后端 API：`http://localhost:3000`
- 前端 H5：`http://localhost:5173`
- 微信小程序：通过微信开发者工具预览

---

## 停止服务
- 前端/后端窗口 `Ctrl + C`
- 停止数据库容器：

```powershell
docker-compose down
```
