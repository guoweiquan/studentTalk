# å˜æ›´æ–‡æ¡£

## å˜æ›´æ—¥æœŸï¼š2026-01-31ï¼ˆv1.7ï¼‰

---

## ä¸€ã€è®¾è®¡æ–¹æ¡ˆæ›´æ–°ï¼ˆv1.6 â†’ v1.7ï¼‰

### 1.1 æ–°å¢æœç´¢è”æƒ³åŠŸèƒ½

**å˜æ›´è¯´æ˜**ï¼šåœ¨è®°å½•åˆ—è¡¨é¡µçš„æœç´¢æ¡†ä¸­ï¼Œè¾“å…¥å­¦ç”Ÿå§“åæ—¶å®æ—¶ä»æ•°æ®åº“è·å–åŒ¹é…çš„å­¦ç”Ÿå§“ååˆ—è¡¨

#### åŠŸèƒ½ç‰¹æ€§

| ç‰¹æ€§ | è¯´æ˜ |
| :--- | :--- |
| é˜²æŠ–å¤„ç† | è¾“å…¥åå»¶è¿Ÿ300mså†å‘èµ·è¯·æ±‚ |
| å»é‡æ˜¾ç¤º | è¿”å›çš„å­¦ç”Ÿå§“åå»é‡åæ˜¾ç¤º |
| æ¨¡ç³ŠåŒ¹é… | æ”¯æŒå§“åä»»æ„ä½ç½®åŒ¹é… |
| ç»“æœé™åˆ¶ | æœ€å¤šæ˜¾ç¤º10æ¡å»ºè®® |
| äº¤äº’ä½“éªŒ | ç‚¹å‡»è”æƒ³é¡¹å¡«å…¥æœç´¢æ¡†å¹¶æ‰§è¡Œæœç´¢ |

#### åç«¯ API æ–°å¢

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | å‚æ•° |
| :--- | :--- | :--- | :--- |
| å­¦ç”Ÿå§“åè”æƒ³ | GET | `/api/v1/record/suggest` | `keyword`: æœç´¢å…³é”®å­— |

**SQL æŸ¥è¯¢é€»è¾‘**ï¼š
```sql
SELECT DISTINCT student_name 
FROM talk_record 
WHERE student_name LIKE '%å…³é”®å­—%'
ORDER BY student_name
LIMIT 10;
```

#### å½±å“èŒƒå›´

**åç«¯ä»£ç å˜æ›´**ï¼š
- æ–°å¢ `backend/src/app/api/v1/record/suggest/route.ts`ï¼šå­¦ç”Ÿå§“åè”æƒ³ API

**å‰ç«¯ä»£ç å˜æ›´**ï¼š
- `frontend/src/api/index.ts`ï¼šæ–°å¢ `getStudentSuggestions` å‡½æ•°
- `frontend/src/pages/record-list/index.vue`ï¼š
  - æ–°å¢ `suggestions` å“åº”å¼å˜é‡ï¼ˆè”æƒ³ç»“æœåˆ—è¡¨ï¼‰
  - æ–°å¢ `showSuggestions` å“åº”å¼å˜é‡ï¼ˆæ§åˆ¶ä¸‹æ‹‰æ˜¾ç¤ºï¼‰
  - æ–°å¢ `debounce` å·¥å…·å‡½æ•°ï¼ˆé˜²æŠ–å¤„ç†ï¼‰
  - æ–°å¢è”æƒ³ä¸‹æ‹‰ç»„ä»¶åŠæ ·å¼
  - æ–°å¢ `handleInputChange` å‡½æ•°ï¼ˆå¤„ç†è¾“å…¥å˜åŒ–ï¼‰
  - æ–°å¢ `selectSuggestion` å‡½æ•°ï¼ˆé€‰æ‹©è”æƒ³é¡¹ï¼‰

---

### 1.2 è®°å½•åˆ—è¡¨å•è¡Œå±•ç¤º

**å˜æ›´è¯´æ˜**ï¼šå°†è®°å½•åˆ—è¡¨ä¸­æ¯æ¡è®°å½•ä»åŸæ¥çš„3è¡Œå±•ç¤ºå‹ç¼©ä¸º1è¡Œå±•ç¤º

#### å˜æ›´å‰åå¯¹æ¯”

**å˜æ›´å‰ï¼ˆ3è¡Œï¼‰**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç‹è€äº”                     2026-01-30 â”‚  â† ç¬¬1è¡Œ
â”‚ æ‰“æ¶                         å…­å¹´çº§3ç­ â”‚  â† ç¬¬2è¡Œ
â”‚ ä¸­é£é™©                                â”‚  â† ç¬¬3è¡Œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å˜æ›´åï¼ˆ1è¡Œï¼‰**ï¼š
```
â”‚ ç‹è€äº” â”‚ æ‰“æ¶ â”‚ ğŸŸ¡ä¸­ â”‚ å…­å¹´3ç­ â”‚ 01-30 â”‚
```

#### å­—æ®µæ˜¾ç¤ºé¡ºåº

| ä¼˜å…ˆçº§ | å­—æ®µ | æ˜¾ç¤ºå¤„ç† | è¯´æ˜ |
| :--- | :--- | :--- | :--- |
| 1 | å­¦ç”Ÿå§“å | æœ€å¤š4å­—ï¼Œè¶…å‡ºæˆªæ–­ | ä¸»è¦æ ‡è¯† |
| 2 | äº‹ç”± | æœ€å¤š4å­—ï¼Œè¶…å‡ºæˆªæ–­ | å¿«é€Ÿäº†è§£è°ˆè¯åŸå›  |
| 3 | é£é™©ç­‰çº§ | å½©è‰²åœ†ç‚¹+å•å­— | ğŸŸ¢ä½ / ğŸŸ¡ä¸­ / ğŸ”´é«˜ |
| 4 | å¹´çº§ç­çº§ | ç®€å†™æ˜¾ç¤º | å¦‚"å…­å¹´3ç­" |
| 5 | æ—¥æœŸ | MM-DDæ ¼å¼ | çœç•¥å¹´ä»½ |

#### å½±å“èŒƒå›´

**å‰ç«¯ä»£ç å˜æ›´**ï¼š
- `frontend/src/pages/record-list/index.vue`ï¼š
  - é‡æ„åˆ—è¡¨é¡¹æ¨¡æ¿ç»“æ„ï¼ˆä»å¤šè¡Œæ”¹ä¸ºå•è¡Œ flex å¸ƒå±€ï¼‰
  - æ–°å¢ `formatDate` å‡½æ•°ï¼ˆæ ¼å¼åŒ–æ—¥æœŸä¸º MM-DDï¼‰
  - æ–°å¢ `getRiskIcon` å‡½æ•°ï¼ˆè¿”å›é£é™©ç­‰çº§å¯¹åº”çš„å›¾æ ‡ï¼‰
  - æ–°å¢ `truncateText` å‡½æ•°ï¼ˆæ–‡æœ¬æˆªæ–­å¤„ç†ï¼‰
  - æ›´æ–° CSS æ ·å¼ï¼ˆå•è¡Œå¸ƒå±€ã€å“åº”å¼é€‚é…ï¼‰

---

## äºŒã€æºä»£ç æ›´æ–°

### 2.1 åç«¯ä»£ç æ›´æ–°

#### æ–°å¢æ–‡ä»¶ï¼š`backend/src/app/api/v1/record/suggest/route.ts`

**åŠŸèƒ½è¯´æ˜**ï¼šæä¾›å­¦ç”Ÿå§“åè”æƒ³æŸ¥è¯¢æ¥å£

**æ¥å£å®šä¹‰**ï¼š
- æ–¹æ³•ï¼šGET
- å‚æ•°ï¼š`keyword` (æŸ¥è¯¢å‚æ•°)
- è¿”å›ï¼šå»é‡çš„å­¦ç”Ÿå§“åæ•°ç»„

---

### 2.2 å‰ç«¯ä»£ç æ›´æ–°

#### æ–‡ä»¶ï¼š`frontend/src/api/index.ts`

**æ–°å¢å†…å®¹**ï¼š
```typescript
// è·å–å­¦ç”Ÿå§“åè”æƒ³
export async function getStudentSuggestions(keyword: string): Promise<ApiResponse<string[]>> {
  return request<string[]>(`/record/suggest?keyword=${encodeURIComponent(keyword)}`);
}
```

#### æ–‡ä»¶ï¼š`frontend/src/pages/record-list/index.vue`

**ä¸»è¦å˜æ›´**ï¼š
1. æ–°å¢æœç´¢è”æƒ³ä¸‹æ‹‰ç»„ä»¶
2. ä¿®æ”¹åˆ—è¡¨é¡¹ä¸ºå•è¡Œ flex å¸ƒå±€
3. æ–°å¢é˜²æŠ–å¤„ç†é€»è¾‘
4. æ–°å¢æ–‡æœ¬æ ¼å¼åŒ–å·¥å…·å‡½æ•°

---

## å˜æ›´æ—¥æœŸï¼š2026-01-29ï¼ˆä¸‹åˆ - v1.5ï¼‰

---

## ä¸€ã€è®¾è®¡æ–¹æ¡ˆæ›´æ–°ï¼ˆv1.4 â†’ v1.5ï¼‰

### 1.1 æ‰©å±•æ–‡æœ¬è¾“å…¥åŒºåŸŸ

**å˜æ›´è¯´æ˜**ï¼šå°†åŸ"è°ˆè¯è®°å½•"å•ä¸€è¾“å…¥åŒºåŸŸæ‰©å±•ä¸ºä¸‰ä¸ªç‹¬ç«‹çš„æ–‡æœ¬è¾“å…¥åŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸéƒ½æ”¯æŒè¯­éŸ³è¾“å…¥å’Œæ‹ç…§è¯†åˆ«

#### æ–°å¢å­—æ®µ

| å­—æ®µ | è¯´æ˜ | è¾“å…¥æ–¹å¼ |
| :--- | :--- | :--- |
| è°ˆè¯è®°å½• | è®°å½•è°ˆè¯äº‹ç”±åŠè¯¦ç»†å†…å®¹ | æ–‡æœ¬è¾“å…¥ + è¯­éŸ³ + OCR |
| æƒ…å†µåˆ†æ | åˆ†æå­¦ç”Ÿæƒ…å†µåŠåŸå›  | æ–‡æœ¬è¾“å…¥ + è¯­éŸ³ + OCR |
| å¤„ç½®ç»“æœ | è®°å½•å¤„ç½®æªæ–½å’Œç»“æœ | æ–‡æœ¬è¾“å…¥ + è¯­éŸ³ + OCR |

#### å½±å“èŒƒå›´

**æ•°æ®åº“å˜æ›´**ï¼š
- `init.sql`ï¼šç‰ˆæœ¬å·æ›´æ–°ä¸ºv1.5
- `talk_record`è¡¨æ–°å¢å­—æ®µï¼š
  - `situation_analysis` TEXT - æƒ…å†µåˆ†æ
  - `disposal_result` TEXT - å¤„ç½®ç»“æœ

**åç«¯ä»£ç å˜æ›´**ï¼š
- `backend/prisma/schema.prisma`ï¼šTalkRecordæ¨¡å‹æ–°å¢`situationAnalysis`å’Œ`disposalResult`å­—æ®µ
- `backend/src/app/api/v1/record/route.ts`ï¼šCreateRecordBodyæ¥å£ã€å“åº”æ˜ å°„ã€åˆ›å»ºé€»è¾‘æ–°å¢å­—æ®µ
- `backend/src/app/api/v1/record/[id]/route.ts`ï¼šGETå“åº”æ–°å¢å­—æ®µ

**å‰ç«¯ä»£ç å˜æ›´**ï¼š
- `frontend/src/api/index.ts`ï¼šTalkRecordå’ŒCreateRecordRequestæ¥å£æ–°å¢å­—æ®µ
- `frontend/src/pages/record-add/index.vue`ï¼š
  - `formData`æ–°å¢`situation_analysis`å’Œ`disposal_result`å­—æ®µ
  - æ–°å¢6ä¸ªç‹¬ç«‹çš„å½•éŸ³/OCRçŠ¶æ€å˜é‡ï¼ˆæ¯ä¸ªåŒºåŸŸå„2ä¸ªï¼‰
  - æ–°å¢`currentRecordingField`ç”¨äºè¿½è¸ªå½“å‰å½•éŸ³ç›®æ ‡
  - æ–°å¢`setRecordingState`ã€`setOcrProcessingState`ã€`appendTextToField`ã€`isFieldRecording`è¾…åŠ©å‡½æ•°
  - æ›´æ–°`handleVoiceInput(targetField)`æ”¯æŒç›®æ ‡å­—æ®µå‚æ•°
  - æ›´æ–°`handleOcrInput(targetField)`æ”¯æŒç›®æ ‡å­—æ®µå‚æ•°
  - æ¨¡æ¿æ–°å¢"æƒ…å†µåˆ†æ"å’Œ"å¤„ç½®ç»“æœ"ä¸¤ä¸ªç‹¬ç«‹çš„è¾“å…¥å¡ç‰‡
  - æ›´æ–°`createRecord`è°ƒç”¨åŒ…å«æ–°å­—æ®µ

---

## å˜æ›´æ—¥æœŸï¼š2026-01-29ï¼ˆä¸‹åˆï¼‰

---

## ä¸€ã€è®¾è®¡æ–¹æ¡ˆæ›´æ–°ï¼ˆv1.3 â†’ v1.4ï¼‰

### 1.1 æ–°å¢"åœºæ™¯"é€‰æ‹©åŠŸèƒ½

**å˜æ›´è¯´æ˜**ï¼šåœ¨æ–°å¢è®°å½•é¡µ"å‚ä¸äºº"ä¸Šæ–¹æ·»åŠ "åœºæ™¯"å•é¡¹é€‰æ‹©æ¡†ï¼Œå®ç°æ ‡ç­¾æŒ‰åœºæ™¯è¿‡æ»¤æ˜¾ç¤º

#### åœºæ™¯é€‰é¡¹

| åœºæ™¯ | å¯¹åº” tag_type | è¯´æ˜ |
| :--- | :--- | :--- |
| å…¨éƒ¨ï¼ˆé»˜è®¤ï¼‰ | ä¸è¿‡æ»¤ | æ˜¾ç¤ºæ‰€æœ‰åœºæ™¯çš„æ ‡ç­¾ï¼Œç›¸åŒtag_valueå»é‡æ˜¾ç¤º |
| å­¦ä¸š | `å­¦ä¸š` | æ˜¾ç¤ºå­¦ä¸šç±»å‹çš„æ ‡ç­¾ |
| è¿çºª | `è¿çºª` | æ˜¾ç¤ºè¿çºªç±»å‹çš„æ ‡ç­¾ |
| å¿ƒç† | `å¿ƒç†` | æ˜¾ç¤ºå¿ƒç†ç±»å‹çš„æ ‡ç­¾ |
| å®¿èˆ | `å®¿èˆ` | æ˜¾ç¤ºå®¿èˆç±»å‹çš„æ ‡ç­¾ |

#### è”åŠ¨è¿‡æ»¤è§„åˆ™

1. **é»˜è®¤æ˜¾ç¤ºå…¨éƒ¨**ï¼š"åœºæ™¯"ä¸ºéå¿…é€‰é¡¹ï¼Œé»˜è®¤å€¼ä¸º"å…¨éƒ¨"ï¼Œæ˜¾ç¤ºæ‰€æœ‰åœºæ™¯çš„æ ‡ç­¾ï¼Œä½†ç›¸åŒtag_valueéœ€å»é‡
2. **æŒ‰åœºæ™¯è¿‡æ»¤**ï¼šé€‰æ‹©æŸä¸ªåœºæ™¯åï¼Œ"äº‹ç”±/é—®é¢˜ã€å­¦ç”Ÿè¡¨ç°ã€åŸå› åˆ†æã€å¤„ç½®ç»“æœ"4ä¸ªåŒºåŸŸåªæ˜¾ç¤ºå¯¹åº”tag_typeçš„æ ‡ç­¾
3. **å‚ä¸äººä¸è¿‡æ»¤**ï¼š"å‚ä¸äºº"åŒºåŸŸå§‹ç»ˆæ˜¾ç¤ºæ‰€æœ‰æ ‡ç­¾ï¼Œä¸å—åœºæ™¯é€‰æ‹©å½±å“
4. **ä¿ç•™å·²é€‰æ•°æ®**ï¼šåˆ‡æ¢åœºæ™¯æ—¶ï¼Œå·²é€‰ä¸­çš„æ ‡ç­¾ä¸ä¼šä¸¢å¤±ï¼Œå³ä½¿æ–°åœºæ™¯æ²¡æœ‰è¯¥æ ‡ç­¾é€‰é¡¹

#### å½±å“èŒƒå›´

**è®¾è®¡æ–‡æ¡£å˜æ›´**ï¼š
- è®¾è®¡æ–¹æ¡ˆv1.1.mdï¼šç‰ˆæœ¬å·æ›´æ–°ä¸ºv1.4
- 1.7 v1.4ç‰ˆæœ¬å˜æ›´ç‚¹ï¼šæ–°å¢ç« èŠ‚æè¿°åŠŸèƒ½
- 3.1 æ–°å¢è®°å½•é¡µï¼šé¡µé¢å¸ƒå±€å›¾ã€è¡¨å•å­—æ®µè¡¨æ ¼ã€åœºæ™¯è”åŠ¨è¿‡æ»¤è¯´æ˜

**å‰ç«¯ä»£ç å˜æ›´**ï¼š
- `frontend/src/pages/record-add/index.vue`ï¼š
  - æ¨¡æ¿æ–°å¢"åœºæ™¯"å•é€‰æ¡†ç»„ä»¶ï¼ˆåœ¨"å‚ä¸äºº"å¡ç‰‡ä¹‹å‰ï¼‰
  - æ–°å¢`sceneOptions`åœºæ™¯é€‰é¡¹é…ç½®æ•°ç»„
  - æ–°å¢`selectedScene`å“åº”å¼å˜é‡ï¼ˆé»˜è®¤å€¼ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œè¡¨ç¤º"å…¨éƒ¨"ï¼‰
  - æ–°å¢`getFilteredTags(category)`æ–¹æ³•ï¼š
    - å½“é€‰æ‹©"å…¨éƒ¨"æ—¶ï¼Œè¿”å›æ‰€æœ‰æ ‡ç­¾ä½†æŒ‰`tag_value`å»é‡
    - å½“é€‰æ‹©ç‰¹å®šåœºæ™¯æ—¶ï¼Œè¿”å›å¯¹åº”`tag_type`çš„æ ‡ç­¾
  - æ›´æ–°"äº‹ç”±/é—®é¢˜ã€å­¦ç”Ÿè¡¨ç°ã€åŸå› åˆ†æã€å¤„ç½®ç»“æœ"4ä¸ªåŒºåŸŸçš„v-forä½¿ç”¨`getFilteredTags`
  - "å‚ä¸äºº"åŒºåŸŸä¿æŒä½¿ç”¨åŸå§‹`tagOptions.participants`ï¼ˆä¸å—åœºæ™¯å½±å“ï¼‰
  - æ–°å¢`.scene-group`ã€`.scene-item`ã€`.scene-dot`ç­‰CSSæ ·å¼

---

## å˜æ›´æ—¥æœŸï¼š2026-01-29

---

## ä¸€ã€è®¾è®¡æ–¹æ¡ˆæ›´æ–°ï¼ˆv1.3 â†’ v1.4ï¼‰

### 1.1 æ–°å¢å¿«æ·æ ‡ç­¾ç±»å‹åˆ†ç»„åŠŸèƒ½

**å˜æ›´è¯´æ˜**ï¼šåœ¨å¿«æ·æ ‡ç­¾é…ç½®é¡µé¢ï¼Œæ ‡ç­¾æŒ‰ç±»å‹ï¼ˆå­¦ä¸šã€è¿çºªã€å¿ƒç†ã€å®¿èˆï¼‰åˆ†ç»„å±•ç¤ºå’Œç®¡ç†

#### æ ‡ç­¾ç±»å‹å®šä¹‰

| ç±»å‹ | è¯´æ˜ | é¢œè‰²æ ‡è¯† |
| :--- | :--- | :--- |
| å­¦ä¸š | ä¸å­¦ä¹ ç›¸å…³çš„æ ‡ç­¾ | ç°è‰²ï¼ˆé»˜è®¤ï¼‰ |
| è¿çºª | ä¸çºªå¾‹ç›¸å…³çš„æ ‡ç­¾ | æ©™è‰² |
| å¿ƒç† | ä¸å¿ƒç†å¥åº·ç›¸å…³çš„æ ‡ç­¾ | ç»¿è‰² |
| å®¿èˆ | ä¸å®¿èˆç›¸å…³çš„æ ‡ç­¾ | è“è‰² |

#### æ•°æ®åº“å˜æ›´

**è¡¨ï¼š`quick_tag_detail`**
- æ–°å¢å­—æ®µï¼š`tag_type VARCHAR(20) DEFAULT 'å­¦ä¸š'`
- ç”¨äºåŒºåˆ†æ ‡ç­¾å±äºå“ªç§ç±»å‹

**Prisma Schema å˜æ›´**ï¼š
```prisma
model QuickTagDetail {
  // ... å…¶ä»–å­—æ®µ
  tagType    String   @default("å­¦ä¸š") @map("tag_type") @db.VarChar(20)
}
```

#### åç«¯ API å˜æ›´

**GET /api/v1/quick-tag** - è·å–æ‰€æœ‰æ ‡ç­¾
- è¿”å›æ•°æ®æ–°å¢ `tag_type` å­—æ®µ

**POST /api/v1/quick-tag/:id/detail** - æ·»åŠ æ ‡ç­¾
- è¯·æ±‚ä½“æ–°å¢å¯é€‰å‚æ•° `tag_type`ï¼ˆé»˜è®¤ï¼šå­¦ä¸šï¼‰
- æœ‰æ•ˆå€¼ï¼šå­¦ä¸šã€è¿çºªã€å¿ƒç†ã€å®¿èˆ

**GET /api/v1/quick-tag/:id/details** - è·å–ç±»åˆ«æ˜ç»†
- è¿”å›æ•°æ®æ–°å¢ `tag_type` å­—æ®µ

#### å‰ç«¯å˜æ›´

**æ–‡ä»¶ï¼š`frontend/src/api/index.ts`**
- `TagDetail` æ¥å£æ–°å¢ `tag_type` å­—æ®µ
- æ–°å¢ `TAG_TYPES` å¸¸é‡å’Œ `TagType` ç±»å‹
- `addTagDetail` å‡½æ•°æ–°å¢ `tagType` å‚æ•°

**æ–‡ä»¶ï¼š`frontend/src/pages/quick-tag/index.vue`**
- é¡µé¢é‡æ„ï¼šæŒ‰æ ‡ç­¾ç±»å‹åˆ†ç»„å±•ç¤º
- æ–°å¢ç±»å‹é€‰æ‹©å™¨ï¼ˆæ·»åŠ æ ‡ç­¾æ—¶é€‰æ‹©ç±»å‹ï¼‰
- ä¸åŒç±»å‹æ ‡ç­¾ç”¨ä¸åŒé¢œè‰²åŒºåˆ†
- "å‚ä¸äºº"ç±»åˆ«ä¸æŒ‰ç±»å‹åˆ†ç»„ï¼Œå…¶ä»–4ä¸ªç±»åˆ«æ”¯æŒ

#### è®¾è®¡æ–‡æ¡£å˜æ›´

**æ–‡ä»¶ï¼š`è®¾è®¡æ–¹æ¡ˆv1.1.md`**
- 3.4 å¿«æ·æ ‡ç­¾é…ç½®é¡µï¼šæ›´æ–°é¡µé¢å¸ƒå±€å›¾å’Œäº¤äº’è¯´æ˜
- 4.3 å¿«æ·æ ‡ç­¾æ˜ç»†è¡¨ï¼šæ–°å¢ `tag_type` å­—æ®µå®šä¹‰

---

### 1.2 åŒåæ ‡ç­¾å¯åœ¨ä¸åŒç±»å‹ä¸‹é‡å¤æ·»åŠ 

**å˜æ›´è¯´æ˜**ï¼šä¿®æ”¹å”¯ä¸€æ€§æ£€æŸ¥é€»è¾‘ï¼Œå…è®¸åŒä¸€ç±»åˆ«ä¸‹ï¼ŒåŒåæ ‡ç­¾å¯ä»¥åœ¨ä¸åŒç±»å‹ä¸‹é‡å¤æ·»åŠ 

**ä¿®æ”¹å‰**ï¼š
- åŒä¸€ç±»åˆ«ä¸‹ï¼Œ`tag_value` å¿…é¡»å”¯ä¸€
- ä¾‹å¦‚ï¼š"äº‹ç”±/é—®é¢˜"ç±»åˆ«ä¸‹åªèƒ½æœ‰ä¸€ä¸ª"è¿Ÿåˆ°"æ ‡ç­¾

**ä¿®æ”¹å**ï¼š
- åŒä¸€ç±»åˆ«ä¸‹ï¼Œ`tag_value + tag_type` ç»„åˆå¿…é¡»å”¯ä¸€
- ä¾‹å¦‚ï¼š"äº‹ç”±/é—®é¢˜"ç±»åˆ«ä¸‹ï¼Œ"å­¦ä¸š"ç±»å‹å¯ä»¥æœ‰"è¿Ÿåˆ°"ï¼Œ"è¿çºª"ç±»å‹ä¹Ÿå¯ä»¥æœ‰"è¿Ÿåˆ°"

**æ¶‰åŠæ–‡ä»¶**ï¼š
- `backend/src/app/api/v1/quick-tag/[id]/detail/route.ts`

**ä»£ç å˜æ›´**ï¼š
```typescript
// ä¿®æ”¹å‰ï¼šåªæ£€æŸ¥ tag_value
const existingDetail = await prisma.quickTagDetail.findFirst({
    where: {
        tagId: tagId,
        tagValue: body.tag_value.trim(),
    },
});

// ä¿®æ”¹åï¼šæ£€æŸ¥ tag_value + tag_type ç»„åˆ
const existingDetail = await prisma.quickTagDetail.findFirst({
    where: {
        tagId: tagId,
        tagValue: body.tag_value.trim(),
        tagType: tagType,
    },
});
```

---

### 1.3 éšè—ç©ºçš„æ ‡ç­¾ç±»å‹åˆ†ç»„

**å˜æ›´è¯´æ˜**ï¼šå¿«æ·æ ‡ç­¾é…ç½®é¡µé¢ï¼Œå½“æŸä¸ªç±»å‹ä¸‹æ²¡æœ‰æ ‡ç­¾æ—¶ï¼Œä¸æ˜¾ç¤ºè¯¥ç±»å‹åˆ†ç»„

**ä¿®æ”¹å‰**ï¼š
- æ˜¾ç¤ºæ‰€æœ‰4ä¸ªç±»å‹åˆ†ç»„ï¼ˆå­¦ä¸šã€è¿çºªã€å¿ƒç†ã€å®¿èˆï¼‰
- ç©ºçš„ç±»å‹æ˜¾ç¤º"æš‚æ— æ ‡ç­¾"

**ä¿®æ”¹å**ï¼š
- åªæ˜¾ç¤ºæœ‰æ ‡ç­¾æ•°æ®çš„ç±»å‹åˆ†ç»„
- ç©ºçš„ç±»å‹åˆ†ç»„ä¸æ˜¾ç¤º

**æ¶‰åŠæ–‡ä»¶**ï¼š
- `frontend/src/pages/quick-tag/index.vue`

**ä»£ç å˜æ›´**ï¼š
```vue
<!-- ä¿®æ”¹å‰ -->
<view v-for="tagType in tagTypes" :key="tagType" class="type-section">
  ...
  <view v-if="getDetailsByType(category, tagType).length === 0" class="empty-type">
    <text>æš‚æ— æ ‡ç­¾</text>
  </view>
</view>

<!-- ä¿®æ”¹å -->
<view 
  v-for="tagType in tagTypes" 
  :key="tagType" 
  class="type-section"
  v-show="getDetailsByType(category, tagType).length > 0"
>
  ...
</view>
```

---

### 1.4 æ›´æ–° init.sql è„šæœ¬

**å˜æ›´è¯´æ˜**ï¼šåŒæ­¥æ›´æ–°æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬

**ä¸»è¦å˜æ›´**ï¼š
1. ç‰ˆæœ¬å·æ›´æ–°ä¸º v1.4
2. `talk_record` è¡¨ï¼šç§»é™¤ `raw_text`ã€`followup_date` å­—æ®µï¼Œæ–°å¢ `talk_content` å­—æ®µ
3. `quick_tag` è¡¨ï¼šç±»åˆ«æ•°é‡ä»6ä¸ªæ”¹ä¸º5ä¸ªï¼Œæ›´æ–°ç±»åˆ«åç§°
4. `quick_tag_detail` è¡¨ï¼šæ–°å¢ `tag_type` å­—æ®µ
5. INSERT è¯­å¥ï¼šæ·»åŠ  `tag_type` å€¼ï¼ˆé»˜è®¤"å­¦ä¸š"ï¼‰

**æ¶‰åŠæ–‡ä»¶**ï¼š
- `init.sql`

---

### æ³¨æ„äº‹é¡¹

1. **Prisma å®¢æˆ·ç«¯é‡æ–°ç”Ÿæˆ**ï¼šä¿®æ”¹åéœ€è¦åœ¨åç«¯ç›®å½•æ‰§è¡Œ `npx prisma generate`
2. **ç°æœ‰æ•°æ®è¿ç§»**ï¼šå·²å°†æ‰€æœ‰ç°æœ‰æ ‡ç­¾çš„ `tag_type` åˆå§‹åŒ–ä¸º"å­¦ä¸š"
3. **é‡å¯æœåŠ¡**ï¼šåç«¯ä»£ç æ›´æ–°åéœ€è¦é‡å¯æœåŠ¡

---

## å˜æ›´æ—¥æœŸï¼š2026-01-28

## ä¸€ã€è®¾è®¡æ–¹æ¡ˆæ›´æ–°ï¼ˆv1.2 â†’ v1.3ï¼‰

### 1.1 æ–‡ä»¶ï¼š`è®¾è®¡æ–¹æ¡ˆv1.1.md`

**ç‰ˆæœ¬æ›´æ–°**ï¼šv1.2 â†’ v1.3

---

### 1.11 æ–°å¢è¯­éŸ³è¾“å…¥å’Œæ‹ç…§è¯†åˆ«åŠŸèƒ½

**å˜æ›´è¯´æ˜**ï¼šåœ¨"è°ˆè¯è®°å½•"æ–‡æœ¬æ¡†ä¸‹æ–¹æ–°å¢ä¸¤ä¸ªè¾…åŠ©è¾“å…¥æŒ‰é’®ï¼Œæå‡å½•å…¥æ•ˆç‡

**æ–°å¢åŠŸèƒ½**ï¼š

| åŠŸèƒ½ | æŠ€æœ¯æ–¹æ¡ˆ | è´¹ç”¨ | è¯´æ˜ |
|------|----------|------|------|
| ğŸ¤ è¯­éŸ³è¾“å…¥ | å¾®ä¿¡åŒå£°ä¼ è¯‘æ’ä»¶ | å…è´¹ | å½•éŸ³è½¬æ–‡å­—ï¼Œè¿½åŠ åˆ°æ–‡æœ¬æ¡† |
| ğŸ“· æ‹ç…§è¯†åˆ« | ç™¾åº¦OCR | æ¯å¤©500æ¬¡å…è´¹ | OCRè¯†åˆ«æ‰‹å†™ç¬”è®°ï¼Œè¿½åŠ åˆ°æ–‡æœ¬æ¡† |

**UIå¸ƒå±€**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ * è°ˆè¯è®°å½•                                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚  ï¼ˆæ–‡æœ¬è¾“å…¥åŒºåŸŸï¼‰                            â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   ğŸ¤ è¯­éŸ³è¾“å…¥     â”‚  â”‚   ğŸ“· æ‹ç…§è¯†åˆ«     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é…ç½®è¦æ±‚**ï¼š
1. å¾®ä¿¡åŒå£°ä¼ è¯‘æ’ä»¶ï¼šç™»å½•å¾®ä¿¡å…¬ä¼—å¹³å°æ·»åŠ æ’ä»¶ï¼ˆAppID: `wx069ba97219f66d99`ï¼‰
2. ç™¾åº¦OCRï¼šæ³¨å†Œç™¾åº¦AIå¼€æ”¾å¹³å°ï¼Œè·å–API Keyå’ŒSecret Key

**å½±å“èŒƒå›´**ï¼š
- 3.1 æ–°å¢è®°å½•é¡µï¼šè¡¨å•å­—æ®µå®šä¹‰è¡¨ã€æ–°å¢è¾…åŠ©è¾“å…¥åŠŸèƒ½ç« èŠ‚
- å‰ç«¯ä»£ç ï¼š`frontend/src/pages/record-add/index.vue`
- åç«¯ä»£ç ï¼šæ–°å¢OCRè¯†åˆ«APIæ¥å£
- å°ç¨‹åºé…ç½®ï¼š`manifest.json` æ·»åŠ æ’ä»¶é…ç½®

---

### 1.10 åŸºæœ¬ä¿¡æ¯è¡¨å•å¸ƒå±€è°ƒæ•´

**å˜æ›´è¯´æ˜**ï¼šä¼˜åŒ–æ–°å¢è®°å½•é¡µçš„åŸºæœ¬ä¿¡æ¯åŒºåŸŸå¸ƒå±€

**å¸ƒå±€å˜æ›´**ï¼š

| è¡Œå· | å˜æ›´å‰ | å˜æ›´å |
|------|--------|--------|
| ç¬¬1è¡Œ | å­¦ç”Ÿå§“åï¼ˆæ•´è¡Œï¼‰ | å­¦ç”Ÿå§“åï¼ˆå·¦ï¼‰ + **å­¦å·ï¼ˆå³ï¼‰** |
| ç¬¬2è¡Œ | ç­çº§ï¼ˆå·¦ï¼‰ + å­¦å·ï¼ˆå³ï¼‰ | ç­çº§ï¼ˆå·¦ï¼‰ + **è°ˆè¯åœ°ç‚¹ï¼ˆå³ï¼‰** |
| ç¬¬3è¡Œ | è°ˆè¯æ—¶é—´ï¼ˆå·¦ï¼‰ + è°ˆè¯åœ°ç‚¹ï¼ˆå³ï¼‰ | **è°ˆè¯æ—¶é—´ï¼š2026-01-28**ï¼ˆåªè¯»ï¼Œæ ‡ç­¾ä¸æ—¥æœŸåŒè¡Œï¼‰ |

**è°ˆè¯æ—¶é—´å­—æ®µå˜æ›´**ï¼š
- ç§»é™¤å¿…å¡«æ ‡è®°ï¼ˆçº¢è‰²*å·ï¼‰
- å–æ¶ˆæ—¥æœŸé€‰æ‹©å™¨ï¼Œæ”¹ä¸ºæ–‡æœ¬æ˜¾ç¤º
- è‡ªåŠ¨å¡«å……å½“å‰ç³»ç»Ÿæ—¥æœŸ
- è®¾ä¸ºåªè¯»å±æ€§ï¼Œç”¨æˆ·ä¸å¯ä¿®æ”¹
- æ ‡ç­¾ä¸æ—¥æœŸå€¼åœ¨åŒä¸€è¡Œæ¨ªå‘æ˜¾ç¤º

**å½±å“èŒƒå›´**ï¼š
- 3.1 æ–°å¢è®°å½•é¡µï¼šé¡µé¢å¸ƒå±€å›¾
- 3.1 è¡¨å•å­—æ®µå®šä¹‰è¡¨ï¼šæ›´æ–°å­—æ®µå¸ƒå±€è¯´æ˜ï¼Œè°ˆè¯æ—¶é—´ç±»å‹æ”¹ä¸º Textï¼ˆåªè¯»ï¼‰
- å‰ç«¯ä»£ç ï¼š`frontend/src/pages/record-add/index.vue`

---

### 1.2 ç§»é™¤"åŸå§‹è°ˆè¯ç‰‡æ®µ"åŠŸèƒ½

**å˜æ›´è¯´æ˜**ï¼šç®€åŒ–å½•å…¥æµç¨‹ï¼Œç”¨æˆ·ç›´æ¥å¡«å†™ç»“æ„åŒ–è¡¨å•ï¼Œæ— éœ€ç²˜è´´åŸå§‹è°ˆè¯å†…å®¹å†æ•´ç†

**å½±å“èŒƒå›´**ï¼š
- 1.2 æ ¸å¿ƒåŠŸèƒ½ï¼šç§»é™¤"è°ˆè¯æ•´ç†"åŠŸèƒ½æ¨¡å—
- 1.3 è§’è‰²è®¾å®šä¸ä»»åŠ¡å®šä½ï¼šæ›´æ–°ä»»åŠ¡æè¿°
- 1.4 æ ¸å¿ƒå˜æ›´ç‚¹ï¼šç§»é™¤ç›¸å…³æµç¨‹æè¿°
- 3.1 æ–°å¢è®°å½•é¡µï¼šç§»é™¤é¡µé¢å¸ƒå±€ä¸­çš„åŸå§‹è°ˆè¯ç‰‡æ®µåŒºåŸŸã€å¿«æ·æ ‡ç­¾ç‚¹é€‰åŒºåŸŸã€ä¸€é”®æ•´ç†æŒ‰é’®
- 3.1 è¡¨å•å­—æ®µå®šä¹‰ï¼šç§»é™¤"åŸå§‹è°ˆè¯ç‰‡æ®µ"å­—æ®µ
- 3.1 æ¨¡æ¿ç”Ÿæˆé€»è¾‘ï¼šæ›´æ–°è¯´æ˜
- 4.1 æ•°æ®åº“è®¾è®¡ï¼šç§»é™¤ `raw_text` å­—æ®µ
- 5.3.1 APIè¯·æ±‚ä½“ç¤ºä¾‹ï¼šç§»é™¤ `raw_text` å‚æ•°

---

### 1.3 ç§»é™¤"å…³é”®äº‹å®"å­—æ®µ

**å˜æ›´è¯´æ˜**ï¼šç®€åŒ–è¡¨å•ï¼Œç§»é™¤å…³é”®äº‹å®è¾“å…¥é¡¹

**å½±å“èŒƒå›´**ï¼š
- 3.1 æ–°å¢è®°å½•é¡µï¼šé¡µé¢å¸ƒå±€ã€è¡¨å•å­—æ®µå®šä¹‰ã€æ¨¡æ¿ç”Ÿæˆæ ·å¼
- 5.3.1 APIè¯·æ±‚ä½“ç¤ºä¾‹ï¼šç§»é™¤ `form_data.key_facts`

---

### 1.4 ç§»é™¤"åç»­è·Ÿè¿›è®¡åˆ’"å­—æ®µ

**å˜æ›´è¯´æ˜**ï¼šç®€åŒ–è¡¨å•ï¼Œç§»é™¤åç»­è·Ÿè¿›è®¡åˆ’åŠç›¸å…³å¿«æ·æ ‡ç­¾ç±»åˆ«

**å½±å“èŒƒå›´**ï¼š
- 3.1 æ–°å¢è®°å½•é¡µï¼šé¡µé¢å¸ƒå±€ã€è¡¨å•å­—æ®µå®šä¹‰ã€æ¨¡æ¿ç”Ÿæˆæ ·å¼
- 3.4 å¿«æ·æ ‡ç­¾é…ç½®é¡µï¼šç§»é™¤"åç»­è·Ÿè¿›è®¡åˆ’"ç±»åˆ«åŒºå—
- 3.4 å›ºå®šç±»åˆ«è¡¨æ ¼ï¼šç§»é™¤ `followup_plan` è¡Œï¼Œç±»åˆ«æ•°é‡ä»6ä¸ªæ”¹ä¸º5ä¸ª
- 4.1 æ•°æ®åº“è®¾è®¡ï¼šç§»é™¤ `followup_date` å­—æ®µ
- 4.2 å¿«æ·æ ‡ç­¾ç±»åˆ«è¡¨ï¼šæ›´æ–°ä¸º5ä¸ªå›ºå®šç±»åˆ«ï¼Œç§»é™¤ `followup_plan` åˆå§‹åŒ–æ•°æ®
- 4.3 å¿«æ·æ ‡ç­¾æ˜ç»†è¡¨ï¼šç§»é™¤åç»­è·Ÿè¿›è®¡åˆ’çš„é»˜è®¤æ ‡ç­¾æ•°æ®
- è¡¨å…³ç³»å›¾ï¼šç§»é™¤ `followup_plan` è¡Œ
- 5.3.1 APIè¯·æ±‚ä½“ç¤ºä¾‹ï¼šç§»é™¤ `followup_plan` å’Œ `followup_date`

---

### 1.5 å­—æ®µé‡å‘½å

| åŸåç§° | æ–°åç§° |
|--------|--------|
| å­¦ç”Ÿæ€åº¦/æƒ…ç»ª | **å­¦ç”Ÿè¡¨ç°** |
| å¤„ç†ä¸è¾…å¯¼æªæ–½ | **å¤„ç½®ç»“æœ** |

**å½±å“èŒƒå›´**ï¼š
- 3.1 æ–°å¢è®°å½•é¡µï¼šé¡µé¢å¸ƒå±€ã€è¡¨å•å­—æ®µå®šä¹‰ã€æ¨¡æ¿ç”Ÿæˆæ ·å¼
- 3.4 å¿«æ·æ ‡ç­¾é…ç½®é¡µï¼šé¡µé¢å¸ƒå±€ã€å›ºå®šç±»åˆ«è¡¨æ ¼
- 4.2 å¿«æ·æ ‡ç­¾ç±»åˆ«è¡¨ï¼šåˆå§‹åŒ–SQLä¸­çš„ `category_name`
- 4.3 å¿«æ·æ ‡ç­¾æ˜ç»†è¡¨ï¼šSQLæ³¨é‡Š
- 5.3.1 APIè¯·æ±‚ä½“ç¤ºä¾‹ï¼š`form_data` ä¸­å­—æ®µåæ›´æ–°

---

### 1.6 æ–°å¢"è°ˆè¯è®°å½•"å­—æ®µ

**å˜æ›´è¯´æ˜**ï¼šåœ¨é£é™©ç­‰çº§ä¸‹æ–¹æ–°å¢ Textarea ç±»å‹çš„"è°ˆè¯è®°å½•"å­—æ®µï¼Œç”¨äºè®°å½•è¯¦ç»†è°ˆè¯å†…å®¹

**å­—æ®µç‰¹æ€§**ï¼š
- ç±»å‹ï¼šTextareaï¼ˆçº¯æ–‡æœ¬è¾“å…¥ï¼‰
- ä½ç½®ï¼šé£é™©ç­‰çº§ä¸‹æ–¹ï¼Œè¡¨å•æœ€åä¸€é¡¹
- å­˜å‚¨ï¼šç‹¬ç«‹å­—æ®µ `talk_content`ï¼ˆTEXTç±»å‹ï¼‰

**å½±å“èŒƒå›´**ï¼š
- 3.1 æ–°å¢è®°å½•é¡µï¼šé¡µé¢å¸ƒå±€ã€è¡¨å•å­—æ®µå®šä¹‰ã€æ¨¡æ¿ç”Ÿæˆæ ·å¼
- 4.1 æ•°æ®åº“è®¾è®¡ï¼šæ–°å¢ `talk_content TEXT` å­—æ®µ
- 5.3.1 APIè¯·æ±‚ä½“ç¤ºä¾‹ï¼šæ–°å¢ `talk_content` å‚æ•°

---

### 1.7 æ•°æ®åº“è¡¨ç»“æ„å˜æ›´æ€»ç»“

#### talk_record è¡¨

**ç§»é™¤å­—æ®µ**ï¼š
- `raw_text` TEXT - åŸå§‹è°ˆè¯ç‰‡æ®µ
- `followup_date` DATE - è·Ÿè¿›æ—¥æœŸ

**æ–°å¢å­—æ®µ**ï¼š
- `talk_content` TEXT - è°ˆè¯è®°å½•ï¼ˆè¯¦ç»†å†…å®¹ï¼‰

#### quick_tag è¡¨

**ç±»åˆ«æ•°é‡**ï¼š6ä¸ª â†’ 5ä¸ª

**ç§»é™¤ç±»åˆ«**ï¼š
- `followup_plan` - åç»­è·Ÿè¿›è®¡åˆ’

**é‡å‘½åç±»åˆ«**ï¼š
- `attitude`: "å­¦ç”Ÿæ€åº¦/æƒ…ç»ª" â†’ "å­¦ç”Ÿè¡¨ç°"
- `measures`: "å¤„ç†ä¸è¾…å¯¼æªæ–½" â†’ "å¤„ç½®ç»“æœ"

---

### 1.8 è¡¨å•å­—æ®µæœ€ç»ˆæ¸…å•ï¼ˆå…±11é¡¹ï¼‰

| åºå· | å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|------|--------|------|------|
| 1 | å­¦ç”Ÿå§“å | Input | å¿…å¡« |
| 2 | ç­çº§/å­¦å· | Input | å¿…å¡« |
| 3 | è°ˆè¯æ—¶é—´ | DateTime | é»˜è®¤å½“å‰æ—¶é—´ |
| 4 | è°ˆè¯åœ°ç‚¹ | Input | å¿…å¡« |
| 5 | å‚ä¸äºº | Checkbox + Input | ä»å¿«æ·æ ‡ç­¾åŠ è½½ |
| 6 | äº‹ç”±/é—®é¢˜ | Checkbox + Input | ä»å¿«æ·æ ‡ç­¾åŠ è½½ |
| 7 | å­¦ç”Ÿè¡¨ç° | Checkbox + Input | ä»å¿«æ·æ ‡ç­¾åŠ è½½ |
| 8 | åŸå› åˆ†æ | Checkbox + Input | ä»å¿«æ·æ ‡ç­¾åŠ è½½ |
| 9 | å¤„ç½®ç»“æœ | Checkbox + Input | ä»å¿«æ·æ ‡ç­¾åŠ è½½ |
| 10 | é£é™©ç­‰çº§ | Radio | ä½/ä¸­/é«˜ |
| 11 | è°ˆè¯è®°å½• | Textarea | è‡ªå®šä¹‰è¾“å…¥ |

---

### 1.9 å¿«æ·æ ‡ç­¾ç±»åˆ«æœ€ç»ˆæ¸…å•ï¼ˆå…±5ä¸ªï¼‰

| ç±»åˆ«ç¼–ç  | ç±»åˆ«åç§° | è¯´æ˜ |
|----------|----------|------|
| participants | å‚ä¸äºº | è°ˆè¯å‚ä¸äººå‘˜ |
| reason | äº‹ç”±/é—®é¢˜ | è°ˆè¯äº‹ç”±æˆ–é—®é¢˜ç±»å‹ |
| attitude | å­¦ç”Ÿè¡¨ç° | å­¦ç”Ÿåœ¨è°ˆè¯ä¸­çš„è¡¨ç° |
| analysis | åŸå› åˆ†æ | é—®é¢˜äº§ç”Ÿçš„åŸå›  |
| measures | å¤„ç½®ç»“æœ | é‡‡å–çš„å¤„ç†æ–¹å¼ |

---

## äºŒã€æºä»£ç æ›´æ–°

### 2.1 åç«¯ä»£ç æ›´æ–°

#### æ–‡ä»¶ï¼š`backend/prisma/schema.prisma`

**å˜æ›´å†…å®¹**ï¼š
- ç§»é™¤ `rawText` å­—æ®µ
- ç§»é™¤ `followupDate` å­—æ®µ
- æ–°å¢ `talkContent` å­—æ®µï¼ˆTEXTç±»å‹ï¼‰

#### æ–‡ä»¶ï¼š`backend/src/app/api/v1/record/route.ts`

**å˜æ›´å†…å®¹**ï¼š
- æ›´æ–° `CreateRecordBody` æ¥å£ï¼šç§»é™¤ `raw_text`ã€`followup_date`ï¼Œæ–°å¢ `talk_content`
- æ›´æ–° GET å‡½æ•°å“åº”æ•°æ®ï¼šç§»é™¤æ—§å­—æ®µï¼Œæ–°å¢æ–°å­—æ®µ
- æ›´æ–° POST å‡½æ•°åˆ›å»ºé€»è¾‘ï¼šç§»é™¤æ—§å­—æ®µï¼Œæ–°å¢æ–°å­—æ®µ
- æ›´æ–°å¿…å¡«å­—æ®µéªŒè¯ï¼šç§»é™¤ `raw_text`

#### æ–‡ä»¶ï¼š`backend/src/app/api/v1/record/[id]/route.ts`

**å˜æ›´å†…å®¹**ï¼š
- æ›´æ–° GET å‡½æ•°å“åº”æ•°æ®ï¼šç§»é™¤ `raw_text`ã€`followup_date`ï¼Œæ–°å¢ `talk_content`

---

### 2.2 å‰ç«¯ä»£ç æ›´æ–°

#### æ–‡ä»¶ï¼š`frontend/src/api/index.ts`

**å˜æ›´å†…å®¹**ï¼š
- æ›´æ–° `TalkRecord` æ¥å£ï¼šç§»é™¤æ—§å­—æ®µï¼Œæ–°å¢æ–°å­—æ®µï¼Œé‡å‘½å form_data å†…éƒ¨å­—æ®µ
- æ›´æ–° `CreateRecordRequest` æ¥å£ï¼šç§»é™¤æ—§å­—æ®µï¼Œæ–°å¢æ–°å­—æ®µ

#### æ–‡ä»¶ï¼š`frontend/src/pages/record-add/index.vue`

**å˜æ›´å†…å®¹**ï¼š
- ç§»é™¤"åŸå§‹è°ˆè¯ç‰‡æ®µ"è¾“å…¥åŒºåŸŸ
- ç§»é™¤"å…³é”®äº‹å®"è¾“å…¥åŒºåŸŸ
- ç§»é™¤"åç»­è·Ÿè¿›è®¡åˆ’"å¤é€‰æ¡†åŒºåŸŸ
- å°†"å­¦ç”Ÿæ€åº¦/æƒ…ç»ª"æ”¹ä¸º"å­¦ç”Ÿè¡¨ç°"
- å°†"å¤„ç†ä¸è¾…å¯¼æªæ–½"æ”¹ä¸º"å¤„ç½®ç»“æœ"
- æ–°å¢"è°ˆè¯è®°å½•" Textarea è¾“å…¥åŒºåŸŸ
- æ›´æ–°è¡¨å•æ•°æ®ç»“æ„ï¼ˆformDataï¼‰
- æ›´æ–°ç”Ÿæˆæ¨¡æ¿å‡½æ•°ï¼ˆgenerateContentï¼‰
- æ›´æ–°è¡¨å•éªŒè¯é€»è¾‘ï¼ˆvalidateFormï¼‰
- æ›´æ–°æäº¤å‡½æ•°ï¼ˆhandleSubmitï¼‰

#### æ–‡ä»¶ï¼š`frontend/src/pages/record-detail/index.vue`

**å˜æ›´å†…å®¹**ï¼š
- ç§»é™¤"å…³é”®äº‹å®"å±•ç¤ºå¡ç‰‡
- ç§»é™¤"åŸå§‹è°ˆè¯ç‰‡æ®µ"å±•ç¤ºå¡ç‰‡
- ç§»é™¤"åç»­è·Ÿè¿›è®¡åˆ’"å±•ç¤ºå¡ç‰‡
- å°†"å­¦ç”Ÿæ€åº¦/æƒ…ç»ª"æ”¹ä¸º"å­¦ç”Ÿè¡¨ç°"
- å°†"å¤„ç†ä¸è¾…å¯¼æªæ–½"æ”¹ä¸º"å¤„ç½®ç»“æœ"
- æ–°å¢"è°ˆè¯è®°å½•"å±•ç¤ºå¡ç‰‡

---

### 2.3 æ•°æ®åº“æ›´æ–°

**æ‰§è¡Œçš„SQL**ï¼š
```sql
-- æ›´æ–°å¿«æ·æ ‡ç­¾ç±»åˆ«åç§°
UPDATE quick_tag SET category_name = 'å­¦ç”Ÿè¡¨ç°' WHERE category_code = 'attitude';
UPDATE quick_tag SET category_name = 'å¤„ç½®ç»“æœ' WHERE category_code = 'measures';

-- åˆ é™¤åç»­è·Ÿè¿›è®¡åˆ’ç±»åˆ«
DELETE FROM quick_tag WHERE category_code = 'followup_plan';
```

**æ•°æ®åº“schemaæ›´æ–°**ï¼ˆé€šè¿‡ `prisma db push`ï¼‰ï¼š
- `talk_record` è¡¨ç§»é™¤ `raw_text` åˆ—
- `talk_record` è¡¨ç§»é™¤ `followup_date` åˆ—
- `talk_record` è¡¨æ–°å¢ `talk_content` åˆ—ï¼ˆTEXTç±»å‹ï¼‰

---

### 2.4 æ³¨æ„äº‹é¡¹

1. **Prismaå®¢æˆ·ç«¯é‡æ–°ç”Ÿæˆ**ï¼šç”±äºæ–‡ä»¶è¢«é”å®šï¼Œéœ€è¦é‡å¯VS Codeååœ¨åç«¯ç›®å½•æ‰§è¡Œ `npx prisma generate`
2. **é‡å¯åç«¯æœåŠ¡**ï¼šä»£ç æ›´æ–°åéœ€è¦é‡å¯åç«¯æœåŠ¡æ‰èƒ½ç”Ÿæ•ˆ
3. **é‡æ–°ç¼–è¯‘å‰ç«¯**ï¼šå‰ç«¯ä»£ç æ›´æ–°åéœ€è¦é‡æ–°è¿è¡Œ `npm run dev:h5` æˆ– `npm run dev:mp-weixin`

---

## å˜æ›´æ—¥æœŸï¼š2026-01-27

## ä¸€ã€å¯åŠ¨æ–‡æ¡£æ›´æ–°

### 1.1 æ–‡ä»¶ï¼š`å¯åŠ¨æ­¥éª¤.md`

**å˜æ›´å†…å®¹**ï¼šæ–°å¢ç¬¬4æ­¥"å¯åŠ¨å¾®ä¿¡å°ç¨‹åºå¼€å‘æœåŠ¡"

**æ–°å¢å†…å®¹**ï¼š

```markdown
## 4. å¯åŠ¨å¾®ä¿¡å°ç¨‹åºå¼€å‘æœåŠ¡
æ‰“å¼€æ–°ç»ˆç«¯ï¼Œè¿›å…¥å‰ç«¯ç›®å½•ï¼š

```powershell
cd d:\Code_Repository\studentTalk\frontend
```

å®‰è£…ä¾èµ–ï¼ˆè‹¥æœªå®‰è£…ï¼‰ï¼š

```powershell
npm install
```

å¯åŠ¨å¾®ä¿¡å°ç¨‹åºå¼€å‘æœåŠ¡ï¼š

```powershell
npm run dev:mp-weixin
```

ç¼–è¯‘å®Œæˆåï¼Œä¼šåœ¨ `dist/dev/mp-weixin` ç›®å½•ç”Ÿæˆå°ç¨‹åºä»£ç ã€‚

### ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·

1. æ‰“å¼€ **å¾®ä¿¡å¼€å‘è€…å·¥å…·**
2. é€‰æ‹© **ã€Œå¯¼å…¥é¡¹ç›®ã€**
3. ç›®å½•é€‰æ‹©ï¼š`d:\Code_Repository\studentTalk\frontend\dist\dev\mp-weixin`
4. å¡«å…¥æ‚¨çš„å°ç¨‹åº AppIDï¼ˆæˆ–é€‰æ‹©æµ‹è¯•å·ï¼‰
5. ç‚¹å‡» **ã€Œå¯¼å…¥ã€** å®Œæˆ

> ğŸ’¡ æç¤ºï¼šä¿®æ”¹ä»£ç åä¼šè‡ªåŠ¨é‡æ–°ç¼–è¯‘ï¼Œå¾®ä¿¡å¼€å‘è€…å·¥å…·ä¼šè‡ªåŠ¨åˆ·æ–°é¢„è§ˆã€‚

### æœ¬åœ°è®¾ç½®ï¼ˆå¼€å‘é˜¶æ®µï¼‰

ä¸ºäº†æ–¹ä¾¿æœ¬åœ°å¼€å‘è°ƒè¯•ï¼š
1. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ç‚¹å‡» **ã€Œè¯¦æƒ…ã€**
2. åˆ‡æ¢åˆ° **ã€Œæœ¬åœ°è®¾ç½®ã€**
3. å‹¾é€‰ âœ… **ã€Œä¸æ ¡éªŒåˆæ³•åŸŸåã€web-viewï¼ˆä¸šåŠ¡åŸŸåï¼‰ã€TLS ç‰ˆæœ¬ä»¥åŠ HTTPS è¯ä¹¦ã€**

### ç”Ÿäº§æ„å»º

å¦‚éœ€æ„å»ºç”Ÿäº§ç‰ˆæœ¬ï¼š

```powershell
npm run build:mp-weixin
```

æ„å»ºåçš„ä»£ç ä½äº `dist/build/mp-weixin`ï¼Œå¯ç”¨äºä¸Šä¼ å‘å¸ƒã€‚
```

**åŒæ—¶æ›´æ–°"è®¿é—®åœ°å€"éƒ¨åˆ†**ï¼Œæ–°å¢ï¼š
- å¾®ä¿¡å°ç¨‹åºï¼šé€šè¿‡å¾®ä¿¡å¼€å‘è€…å·¥å…·é¢„è§ˆ

---

## äºŒã€API é…ç½®ä¿®æ”¹

### 2.1 æ–‡ä»¶ï¼š`frontend/src/api/index.ts`

**é—®é¢˜**ï¼š
1. å°ç¨‹åºæ— æ³•è¯†åˆ« localhostï¼Œéœ€è¦ä½¿ç”¨ IP åœ°å€
2. IP åœ°å€ `192.168.0.101` ä¸å®é™…ç”µè„‘ IP `192.168.0.103` ä¸åŒ¹é…
3. å¤–ç½‘è®¿é—®æ—¶ï¼ŒHTTPS é¡µé¢è¯·æ±‚ HTTP èµ„æºå¯¼è‡´ Mixed Content é”™è¯¯

**ä¿®æ”¹å†…å®¹**ï¼š

```typescript
// ä¿®æ”¹å‰
const BASE_URL = 'http://192.168.0.101:3000/api/v1';

// ä¿®æ”¹åï¼ˆå¤–ç½‘è®¿é—®ç‰ˆæœ¬ï¼‰
const BASE_URL = 'https://4cf78f5.r28.cpolar.top/api/v1';

// æœ¬åœ°å¼€å‘ç‰ˆæœ¬ï¼ˆå·²æ³¨é‡Šï¼‰
//const BASE_URL = 'http://192.168.0.103:3000/api/v1';
```

---

## ä¸‰ã€Vite é…ç½®ä¿®æ”¹

### 3.1 æ–‡ä»¶ï¼š`frontend/vite.config.ts`

**é—®é¢˜**ï¼šé€šè¿‡ cpolar å†…ç½‘ç©¿é€è®¿é—® H5 é¡µé¢æ—¶ï¼ŒVite æ‹’ç»å¤–éƒ¨ä¸»æœºè®¿é—®ï¼Œæç¤º "Blocked request. This host is not allowed."

**ä¿®æ”¹å†…å®¹**ï¼š

```typescript
// ä¿®æ”¹å‰
export default defineConfig({
    plugins: [uni()],
    server: {
        port: 5173,
        proxy: {
            '/api': {
                target: 'http://localhost:3000',
                changeOrigin: true,
            },
        },
    },
});

// ä¿®æ”¹å
export default defineConfig({
    plugins: [uni()],
    server: {
        port: 5173,
        host: true, // å…è®¸å¤–éƒ¨è®¿é—®
        allowedHosts: [
            '18bc9de.r28.cpolar.top', // cpolar å†…ç½‘ç©¿é€åŸŸå
            '.cpolar.top', // å…è®¸æ‰€æœ‰ cpolar å­åŸŸå
        ],
        proxy: {
            '/api': {
                target: 'http://localhost:3000',
                changeOrigin: true,
            },
        },
    },
});
```

---

## å››ã€åç«¯ CORS é…ç½®

### 4.1 æ–°å¢æ–‡ä»¶ï¼š`backend/middleware.ts`

**é—®é¢˜**ï¼šè·¨åŸŸè¯·æ±‚ï¼ˆCORSï¼‰éœ€è¦å¤„ç† OPTIONS é¢„æ£€è¯·æ±‚

**æ–°å¢å†…å®¹**ï¼š

```typescript
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

// CORS ä¸­é—´ä»¶ - å¤„ç†è·¨åŸŸè¯·æ±‚
export function middleware(request: NextRequest) {
    // å¤„ç† OPTIONS é¢„æ£€è¯·æ±‚
    if (request.method === 'OPTIONS') {
        return new NextResponse(null, {
            status: 200,
            headers: {
                'Access-Control-Allow-Origin': '*',
                'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',
                'Access-Control-Allow-Headers': 'Content-Type, Authorization, X-Requested-With',
                'Access-Control-Max-Age': '86400',
            },
        });
    }

    // å¯¹äºå…¶ä»–è¯·æ±‚ï¼Œæ·»åŠ  CORS å“åº”å¤´
    const response = NextResponse.next();
    response.headers.set('Access-Control-Allow-Origin', '*');
    response.headers.set('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');
    response.headers.set('Access-Control-Allow-Headers', 'Content-Type, Authorization, X-Requested-With');

    return response;
}

// é…ç½®ä¸­é—´ä»¶åŒ¹é…çš„è·¯å¾„
export const config = {
    matcher: '/api/:path*',
};
```

### 4.2 æ–‡ä»¶ï¼š`backend/src/lib/response.ts`

**é—®é¢˜**ï¼šAPI å“åº”éœ€è¦åŒ…å« CORS å¤´

**ä¿®æ”¹å†…å®¹**ï¼š

```typescript
// æ–°å¢ CORS å“åº”å¤´å¸¸é‡
const corsHeaders = {
    'Access-Control-Allow-Origin': '*',
    'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',
    'Access-Control-Allow-Headers': 'Content-Type, Authorization, X-Requested-With',
};

// æ–°å¢ OPTIONS å“åº”å‡½æ•°
export function options(): NextResponse {
    return new NextResponse(null, {
        status: 200,
        headers: corsHeaders,
    });
}

// ä¿®æ”¹ success å‡½æ•°ï¼Œæ·»åŠ  CORS å¤´
export function success<T>(data: T, message: string = 'success'): NextResponse<ApiResponse<T>> {
    return NextResponse.json(
        {
            code: 200,
            message,
            data,
        },
        { headers: corsHeaders }
    );
}

// ä¿®æ”¹ error å‡½æ•°ï¼Œæ·»åŠ  CORS å¤´
export function error(message: string, code: number = 400): NextResponse<ApiResponse<null>> {
    return NextResponse.json(
        {
            code,
            message,
            data: null,
        },
        { status: code >= 500 ? code : 200, headers: corsHeaders }
    );
}

// ä¿®æ”¹ paginatedSuccess å‡½æ•°ï¼Œæ·»åŠ  CORS å¤´
export function paginatedSuccess<T>(...) {
    return NextResponse.json(
        { ... },
        { headers: corsHeaders }
    );
}
```

### 4.3 æ‰€æœ‰ API è·¯ç”±æ–‡ä»¶æ·»åŠ  OPTIONS å¤„ç†

**ä¿®æ”¹çš„æ–‡ä»¶åˆ—è¡¨**ï¼š
- `backend/src/app/api/v1/quick-tag/route.ts`
- `backend/src/app/api/v1/record/route.ts`
- `backend/src/app/api/v1/record/[id]/route.ts`
- `backend/src/app/api/v1/quick-tag/[id]/detail/route.ts`
- `backend/src/app/api/v1/quick-tag/[id]/details/route.ts`
- `backend/src/app/api/v1/quick-tag/detail/[detailId]/route.ts`

**ç»Ÿä¸€æ·»åŠ çš„å†…å®¹**ï¼š

```typescript
import { success, error, options } from '@/lib/response';

// OPTIONS - å¤„ç† CORS é¢„æ£€è¯·æ±‚
export async function OPTIONS() {
    return options();
}
```

---

## äº”ã€é—®é¢˜æ€»ç»“

| åºå· | é—®é¢˜æè¿° | é”™è¯¯ä¿¡æ¯ | æ ¹æœ¬åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|----------|----------|----------|----------|
| 1 | å¾®ä¿¡å¼€å‘è€…å·¥å…·æŠ¥é”™ | `Cannot read property 'getPreCompileOptions' of undefined` | AppID é…ç½®æ— æ•ˆæˆ–ç¼ºå¤± | ä½¿ç”¨æµ‹è¯•å·æˆ–é…ç½®æ­£ç¡®çš„ AppID |
| 2 | å°ç¨‹åºæ— æ³•åŠ è½½æ•°æ® | ç½‘ç»œè¯·æ±‚å¤±è´¥ | API IP åœ°å€ `192.168.0.101` ä¸å®é™… `192.168.0.103` ä¸åŒ¹é… | æ›´æ–° BASE_URL ä¸ºæ­£ç¡®çš„ IP åœ°å€ |
| 3 | H5 å¤–ç½‘è®¿é—®è¢«æ‹¦æˆª | `Blocked request. This host is not allowed.` | Vite å®‰å…¨ç­–ç•¥ç¦æ­¢å¤–éƒ¨ä¸»æœºè®¿é—® | æ·»åŠ  cpolar åŸŸååˆ° `allowedHosts` é…ç½® |
| 4 | H5 å¤–ç½‘ API è¯·æ±‚å¤±è´¥ | `Mixed Content: ... request has been blocked` | HTTPS é¡µé¢è¯·æ±‚ HTTP èµ„æº | å°† API BASE_URL ä» `http://` æ”¹ä¸º `https://` |

---

## å…­ã€å½“å‰æœåŠ¡é…ç½®

### 6.1 æœ¬åœ°å¼€å‘ç¯å¢ƒ

| æœåŠ¡ | åœ°å€ |
|------|------|
| MySQL æ•°æ®åº“ | localhost:3306 |
| åç«¯ API | http://localhost:3000 |
| H5 å‰ç«¯ | http://localhost:5173 |
| å¾®ä¿¡å°ç¨‹åº | å¾®ä¿¡å¼€å‘è€…å·¥å…·ï¼ˆå¯¼å…¥ dist/dev/mp-weixinï¼‰ |

### 6.2 å¤–ç½‘æµ‹è¯•ç¯å¢ƒï¼ˆcpolar å†…ç½‘ç©¿é€ï¼‰

| æœåŠ¡ | åœ°å€ |
|------|------|
| åç«¯ API | https://4cf78f5.r28.cpolar.top |
| H5 å‰ç«¯ | https://18bc9de.r28.cpolar.top |

---

## ä¸ƒã€æ³¨æ„äº‹é¡¹

1. **cpolar å…è´¹ç‰ˆåœ°å€ä¼šå˜åŒ–**ï¼šæ¯æ¬¡é‡å¯ cpolarï¼Œåˆ†é…çš„åŸŸåå¯èƒ½ä¼šå˜åŒ–ï¼Œéœ€è¦ç›¸åº”æ›´æ–° `frontend/src/api/index.ts` ä¸­çš„ `BASE_URL`

2. **åˆ‡æ¢å¼€å‘/æµ‹è¯•ç¯å¢ƒ**ï¼šåœ¨æœ¬åœ°å¼€å‘å’Œå¤–ç½‘æµ‹è¯•ä¹‹é—´åˆ‡æ¢æ—¶ï¼Œéœ€è¦ä¿®æ”¹ `BASE_URL` é…ç½®

3. **é‡å¯æœåŠ¡ç”Ÿæ•ˆ**ï¼šä¿®æ”¹é…ç½®åéœ€è¦é‡å¯ç›¸åº”çš„æœåŠ¡æ‰èƒ½ç”Ÿæ•ˆ

4. **HTTPS è¦æ±‚**ï¼šå¤–ç½‘è®¿é—®æ—¶ï¼Œå¦‚æœå‰ç«¯ä½¿ç”¨ HTTPSï¼Œåˆ™ API ä¹Ÿå¿…é¡»ä½¿ç”¨ HTTPSï¼Œå¦åˆ™ä¼šè§¦å‘ Mixed Content é”™è¯¯
